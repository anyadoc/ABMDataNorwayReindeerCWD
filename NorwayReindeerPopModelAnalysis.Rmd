---
title: "ABM Norway Reindeer Pop Analysis"
author: "Aniruddha Belsare"
output: html_notebook
---

```{r}
require (dplyr)
require (ggplot2)
require (tibble)
require (tidyverse)
require (data.table)
require (kableExtra)

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_blharvest.csv"
databl <- read_csv(data_github)                                                  #tidyverse
new_databl <- add_column(databl, scenario = rep("baseline", 100))
baseline <- new_databl %>% select(CWDhuntedDeer, scenario)                       #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_sc1harvest.csv"
datasc1 <- read_csv(data_github)
new_datasc1 <- add_column(datasc1, scenario = rep("harvest1", 100))
harvest1 <- new_datasc1 %>% select(CWDhuntedDeer, scenario)                      #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_sc2harvest.csv"
datasc2 <- read_csv(data_github)
new_datasc2 <- add_column(datasc2, scenario = rep("harvest2", 100))
harvest2 <- new_datasc2 %>% select(CWDhuntedDeer, scenario)                      #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_sc3harvest.csv"
datasc3 <- read_csv(data_github)
new_datasc3 <- add_column(datasc3, scenario = rep("harvest3", 100))
harvest3 <- new_datasc3 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_sc4harvest.csv"
datasc4 <- read_csv(data_github)
new_datasc4 <- add_column(datasc4, scenario = rep("harvest4", 100))
harvest4 <- new_datasc4 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_sc5harvest.csv"
datasc5 <- read_csv(data_github)
new_datasc5 <- add_column(datasc5, scenario = rep("harvest5", 100))
harvest5 <- new_datasc5 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_sc6harvest.csv"
datasc6 <- read_csv(data_github)
new_datasc6 <- add_column(datasc6, scenario = rep("harvest6", 100))
harvest6 <- new_datasc6 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_sc7harvest.csv"
datasc7 <- read_csv(data_github)
new_datasc7 <- add_column(datasc7, scenario = rep("harvest7", 100))
harvest7 <- new_datasc7 %>% select(CWDhuntedDeer, scenario)   #dplyr

prepostharvestN <- data.table(x = c("Preharvest", "Postharvest baseline", "Postharvest Scenario 1", "Postharvest Scenario 2","Postharvest Scenario 3","Postharvest Scenario 4","Postharvest Scenario 5", "Postharvest Scenario 6", "Postharvest Scenario 7"),y = c(round (mean(new_databl[["AdultMale"]]), digits=0), round (mean(new_databl[["PHAdultMale"]]), digits=0), round (mean(new_datasc1[["PHAdultMale"]]), digits=0), round(mean(new_datasc2[["PHAdultMale"]]), digits=0), round(mean(new_datasc3[["PHAdultMale"]]), digits=0), round(mean(new_datasc4[["PHAdultMale"]]), digits=0), round(mean(new_datasc5[["PHAdultMale"]]), digits=0), round(mean(new_datasc6[["PHAdultMale"]]), digits=0), round(mean(new_datasc7[["PHAdultMale"]]), digits=0)), z = c(round (mean(new_databl[["YearlingMale"]]), digits=0), round (mean(new_databl[["PHYearlingMale"]]), digits=0),round (mean(new_datasc1[["PHYearlingMale"]]), digits=0), round(mean(new_datasc2[["PHYearlingMale"]]), digits=0), round(mean(new_datasc3[["PHYearlingMale"]]), digits=0), round(mean(new_datasc4[["PHYearlingMale"]]), digits=0), round(mean(new_datasc5[["PHYearlingMale"]]), digits=0), round(mean(new_datasc6[["PHYearlingMale"]]), digits=0), round(mean(new_datasc7[["PHYearlingMale"]]), digits=0)), a = c(round (mean(new_databl[["FawnMale"]]), digits=0), round (mean(new_databl[["PHFawnMale"]]), digits=0),round (mean(new_datasc1[["PHFawnMale"]]), digits=0), round(mean(new_datasc2[["PHFawnMale"]]), digits=0), round(mean(new_datasc3[["PHFawnMale"]]), digits=0), round(mean(new_datasc4[["PHFawnMale"]]), digits=0), round(mean(new_datasc5[["PHFawnMale"]]), digits=0), round(mean(new_datasc6[["PHFawnMale"]]), digits=0), round(mean(new_datasc7[["PHFawnMale"]]), digits=0)), b = c(round (mean(new_databl[["AdultFemale"]]), digits=0), round (mean(new_databl[["PHAdultFemale"]]), digits=0), round (mean(new_datasc1[["PHAdultFemale"]]), digits=0), round(mean(new_datasc2[["PHAdultFemale"]]), digits=0), round(mean(new_datasc3[["PHAdultFemale"]]), digits=0), round(mean(new_datasc4[["PHAdultFemale"]]), digits=0), round(mean(new_datasc5[["PHAdultFemale"]]), digits=0), round(mean(new_datasc6[["PHAdultFemale"]]), digits=0), round(mean(new_datasc7[["PHAdultFemale"]]), digits=0)), c = c(round (mean(new_databl[["YearlingFemale"]]), digits=0), round (mean(new_databl[["PHYearlingFemale"]]), digits=0),round (mean(new_datasc1[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc2[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc3[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc4[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc5[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc6[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc7[["PHYearlingFemale"]]), digits=0)), d = c(round (mean(new_databl[["FawnFemale"]]), digits=0), round (mean(new_databl[["PHFawnFemale"]]), digits=0),round (mean(new_datasc1[["PHFawnFemale"]]), digits=0), round(mean(new_datasc2[["PHFawnFemale"]]), digits=0), round(mean(new_datasc3[["PHFawnFemale"]]), digits=0), round(mean(new_datasc4[["PHFawnFemale"]]), digits=0), round(mean(new_datasc5[["PHFawnFemale"]]), digits=0), round(mean(new_datasc6[["PHFawnFemale"]]), digits=0), round(mean(new_datasc7[["PHFawnFemale"]]), digits=0)))

colnames(prepostharvestN) <- c("N ","Adult_males","Yearling_males", "Fawn_males", "Adult_females", "Yearling_females", "Fawn_females")

kable(prepostharvestN) %>%
  kable_styling(full_width = F) %>%
  column_spec(2, background = "orange") %>%
  column_spec(3, background = "yellow") %>%
  column_spec(4, background = "yellow") %>%
  column_spec(5, background = "orange") %>%
  column_spec(6, background = "yellow") %>%
  column_spec(7, background = "yellow")


scenariodata <- rbind(baseline, harvest1, harvest2, harvest3, harvest4, harvest5, harvest6, harvest7)

p <- ggplot(data = scenariodata, mapping = aes(x = scenario, y = CWDhuntedDeer, by = scenario))  + geom_boxplot(outlier.shape = NA) + geom_jitter(height = 0.075, alpha = 0.2)+
  theme_classic() + scale_y_continuous(breaks = c(0, 5, 10, 15)) + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  geom_hline(yintercept = c(7,10.5,14), color = c("black", "red","blue"),linetype = 2, size = .2) +
  annotate(geom="text", x=7.3, y=7.7, label="50% CWD+ removed",color="black", size = 3) +
  annotate(geom="text", x=7.3, y=11.3, label="75% CWD+ removed",color="red", size = 3) +
  annotate(geom="text", x=7.3, y=14.9, label="100% CWD+ removed",color="blue", size = 3) +
  annotate("text", x = 1, y = 3, label = "*", size = 10, color = "red")

p1 <- p + ylab("Number of\n CWD+ reindeer harvested") + xlab("\n Harvest scenarios\n") 

mod_data <- prepostharvestN[-1,]
colnames(mod_data)[1] <- "scenario"
mod_data[1, 1] = "baseline"
mod_data[2, 1] = "harvest1"
mod_data[3, 1] = "harvest2"
mod_data[4, 1] = "harvest3"
mod_data[5, 1] = "harvest4"
mod_data[6, 1] = "harvest5"
mod_data[7, 1] = "harvest6"
mod_data[8, 1] = "harvest7"

NordfjellaHarvestRegimes <- p1 +
  geom_point(data = mod_data, aes(x=scenario, y=Adult_males*15/610), shape = 21, size = 3.5, alpha = 0.4, fill = "darkred") +
  geom_point(data = mod_data, aes(x=scenario, y=Adult_females*15/610), shape = 21,size = 3.5, alpha = 0.4, fill = "steelblue") +
  scale_y_continuous(limits=c(0,17), breaks = c(0,5,10,15), sec.axis = sec_axis(~ . *610/15, name = "Postharvest abundance\n ", breaks = seq(0,610, by = 100))) 
NordfjellaHarvestRegimes + annotate ("point", x = 5.9, y = 16.9, color = "steelblue", alpha = 0.4, size = 3) + annotate("label", x = 6.6, y = 17, label = "Adult female", size = 3.5) + annotate ("point", x = 7.35, y= 16.9, color = "darkred", alpha = 0.4, size = 3) + annotate("label", x = 8, y = 17, label = "Adult male", size = 3.5) + ggtitle("Nordfjella Harvest regimes")

```

### Hardangervidda Reindeer Population: We simulated 4 prevalence scenarios, and for each prevalence scenario we evaluated 8 harvest regimes.

Prevalence scenario 1: 2 adult males infected

```{r}

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP1bl.csv"
databl <- read_csv(data_github)
new_databl <- add_column(databl, scenario = rep("baseline", 100))
baseline <- new_databl %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP1sc1.csv"
datasc1 <- read_csv(data_github)
new_datasc1 <- add_column(datasc1, scenario = rep("harvest1", 100))
harvest1 <- new_datasc1 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP1sc2.csv"
datasc2 <- read_csv(data_github)
new_datasc2 <- add_column(datasc2, scenario = rep("harvest2", 100))
harvest2 <- new_datasc2 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP1sc3.csv"
datasc3 <- read_csv(data_github)
new_datasc3 <- add_column(datasc3, scenario = rep("harvest3", 100))
harvest3 <- new_datasc3 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP1sc4.csv"
datasc4 <- read_csv(data_github)
new_datasc4 <- add_column(datasc4, scenario = rep("harvest4", 100))
harvest4 <- new_datasc4 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP1sc5.csv"
datasc5 <- read_csv(data_github)
new_datasc5 <- add_column(datasc5, scenario = rep("harvest5", 100))
harvest5 <- new_datasc5 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP1sc6.csv"
datasc6 <- read_csv(data_github)
new_datasc6 <- add_column(datasc6, scenario = rep("harvest6", 100))
harvest6 <- new_datasc6 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP1sc7.csv"
datasc7 <- read_csv(data_github)
new_datasc7 <- add_column(datasc7, scenario = rep("harvest7", 100))
harvest7 <- new_datasc7 %>% select(CWDhuntedDeer, scenario)   #dplyr

prepostharvestN <- data.table(x = c("Preharvest", "Postharvest baseline", "Postharvest Scenario 1", "Postharvest Scenario 2","Postharvest Scenario 3","Postharvest Scenario 4","Postharvest Scenario 5", "Postharvest Scenario 6", "Postharvest Scenario 7"),y = c(round (mean(new_databl[["AdultMale"]]), digits=0), round (mean(new_databl[["PHAdultMale"]]), digits=0), round (mean(new_datasc1[["PHAdultMale"]]), digits=0), round(mean(new_datasc2[["PHAdultMale"]]), digits=0), round(mean(new_datasc3[["PHAdultMale"]]), digits=0), round(mean(new_datasc4[["PHAdultMale"]]), digits=0), round(mean(new_datasc5[["PHAdultMale"]]), digits=0), round(mean(new_datasc6[["PHAdultMale"]]), digits=0), round(mean(new_datasc7[["PHAdultMale"]]), digits=0)), z = c(round (mean(new_databl[["YearlingMale"]]), digits=0), round (mean(new_databl[["PHYearlingMale"]]), digits=0),round (mean(new_datasc1[["PHYearlingMale"]]), digits=0), round(mean(new_datasc2[["PHYearlingMale"]]), digits=0), round(mean(new_datasc3[["PHYearlingMale"]]), digits=0), round(mean(new_datasc4[["PHYearlingMale"]]), digits=0), round(mean(new_datasc5[["PHYearlingMale"]]), digits=0), round(mean(new_datasc6[["PHYearlingMale"]]), digits=0), round(mean(new_datasc7[["PHYearlingMale"]]), digits=0)), a = c(round (mean(new_databl[["FawnMale"]]), digits=0), round (mean(new_databl[["PHFawnMale"]]), digits=0),round (mean(new_datasc1[["PHFawnMale"]]), digits=0), round(mean(new_datasc2[["PHFawnMale"]]), digits=0), round(mean(new_datasc3[["PHFawnMale"]]), digits=0), round(mean(new_datasc4[["PHFawnMale"]]), digits=0), round(mean(new_datasc5[["PHFawnMale"]]), digits=0), round(mean(new_datasc6[["PHFawnMale"]]), digits=0), round(mean(new_datasc7[["PHFawnMale"]]), digits=0)), b = c(round (mean(new_databl[["AdultFemale"]]), digits=0), round (mean(new_databl[["PHAdultFemale"]]), digits=0), round (mean(new_datasc1[["PHAdultFemale"]]), digits=0), round(mean(new_datasc2[["PHAdultFemale"]]), digits=0), round(mean(new_datasc3[["PHAdultFemale"]]), digits=0), round(mean(new_datasc4[["PHAdultFemale"]]), digits=0), round(mean(new_datasc5[["PHAdultFemale"]]), digits=0), round(mean(new_datasc6[["PHAdultFemale"]]), digits=0), round(mean(new_datasc7[["PHAdultFemale"]]), digits=0)), c = c(round (mean(new_databl[["YearlingFemale"]]), digits=0), round (mean(new_databl[["PHYearlingFemale"]]), digits=0),round (mean(new_datasc1[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc2[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc3[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc4[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc5[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc6[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc7[["PHYearlingFemale"]]), digits=0)), d = c(round (mean(new_databl[["FawnFemale"]]), digits=0), round (mean(new_databl[["PHFawnFemale"]]), digits=0),round (mean(new_datasc1[["PHFawnFemale"]]), digits=0), round(mean(new_datasc2[["PHFawnFemale"]]), digits=0), round(mean(new_datasc3[["PHFawnFemale"]]), digits=0), round(mean(new_datasc4[["PHFawnFemale"]]), digits=0), round(mean(new_datasc5[["PHFawnFemale"]]), digits=0), round(mean(new_datasc6[["PHFawnFemale"]]), digits=0), round(mean(new_datasc7[["PHFawnFemale"]]), digits=0)))


colnames(prepostharvestN) <- c("N ","Adult_males","Yearling_males", "Fawn_males", "Adult_females", "Yearling_females", "Fawn_females")

kable(prepostharvestN) %>%
  kable_styling(full_width = F) %>%
  column_spec(2, background = "orange") %>%
  column_spec(3, background = "yellow") %>%
  column_spec(4, background = "yellow") %>%
  column_spec(5, background = "orange") %>%
  column_spec(6, background = "yellow") %>%
  column_spec(7, background = "yellow")

scenariodata <- rbind(baseline, harvest1, harvest2, harvest3, harvest4, harvest5, harvest6, harvest7)

p <- ggplot(data = scenariodata, mapping = aes(x = scenario, y = CWDhuntedDeer, by = scenario))  + geom_boxplot(outlier.shape = NA) +
  geom_jitter(height = 0.075, alpha = 0.2) +
  theme_classic() + scale_y_continuous(breaks = c(0, 1, 2, 3)) + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  geom_hline(yintercept = c(1, 1.5, 2), color = c("black", "red","blue"),linetype = 2, size = .2) +
  annotate(geom="text", x=7.3, y=1.1, label="50% CWD+ removed",color="black", size = 3) +
  annotate(geom="text", x=7.3, y=1.6, label="75% CWD+ removed",color="red", size = 3) +
  annotate(geom="text", x=7.3, y=2.2, label="100% CWD+ removed",color="blue", size = 3)  #P4 scale_y_cont 0,5,10,15,25;;geom_hline 12.5,18.75,25;;50% annotate y=13.4,19.5, 26.1)#P3 scale_y_cont 0,5,10,15;;geom_hline 6.5,9.75,13;;50%7,10.16,13.8##p2 scale_y_cont 0,1,2,3,4,5;geom_h_line 2,3,4;50%2.3,3.3,4.4;##p1:scale_y_cont 0,1,2,3;;geom_h_line1,1.5,2;;50% 1.1,1.6,2.2
#aes(color = scenario),for geom_jitter
## to add p(elimination) on the plot:  geom_count(data = filter(scenariodata, CWDhuntedDeer == 2), aes(scenario, CWDhuntedDeer)) +
  #geom_text(aes(y = 2.3,label = paste0("n = ", n)), data = scenariodata) +aes(label = count), color = "#ffffff"

#,axis.title.x = element_blank()) + geom_boxplot(outlier.shape = NA)
p1 <- p + ylab("Number of\n CWD+ reindeer harvested") + xlab("\n Harvest scenarios\n") 
  
p1


#ggsave("Nordjfella1Hscenarios20Oct20_boxplot.png")
mod_data <- prepostharvestN[-1,]
colnames(mod_data)[1] <- "scenario"
mod_data[1, 1] = "baseline"
mod_data[2, 1] = "harvest1"
mod_data[3, 1] = "harvest2"
mod_data[4, 1] = "harvest3"
mod_data[5, 1] = "harvest4"
mod_data[6, 1] = "harvest5"
mod_data[7, 1] = "harvest6"
mod_data[8, 1] = "harvest7"

HardangerviddaPrev1 <- p1 +
  geom_point(data = mod_data, aes(x=scenario, y=Adult_males*3/6000), shape = 21, size = 3.5, alpha = 0.4, fill = "darkred") +
  geom_point(data = mod_data, aes(x=scenario, y=Adult_females*3/6000), shape = 21,size = 3.5, alpha = 0.4, fill = "steelblue") +
  scale_y_continuous(limits=c(0, 3), breaks = c(0, 1, 2, 3), sec.axis = sec_axis(~ . *6000/3, name = "Postharvest abundance\n ", breaks = seq(0,6000, by = 1000))) #P4 25/6000;;scale_y_cont limits 0,27;;breaks 0,5,10,15,20,25;;p3 15/6000;;scale_y 0,15;;breaks 0,5,10,15;p2:3/6000, scale y 0,5; breaks 0,1,2,3,4,5;##p1:3/6000;;scale_y0,3;;breaks:0,1,2,3
HardangerviddaPrev1 + annotate ("point", x = 0.9, y = 2.8, color = "steelblue", alpha = 0.4, size = 3) + annotate("label", x = 1.6, y = 2.8, label = "Adult female", size = 3.5) + annotate ("point", x = 2.35, y= 2.8, color = "darkred", alpha = 0.4, size = 3) + annotate("label", x = 2.97, y = 2.8, label = "Adult male", size = 3.5) + ggtitle ("Hardangervidda Prevalence Scenario 1 Harvest regimes")#P4 26.9/26.7/p314.4/p2 4.8/p1 2.8
#ggsave("Hv_P2_Fig1.png")

```

Prevalence scenario 2: 3 adult males and 1 adult female infected

```{r}
data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP2bl.csv"
databl <- read_csv(data_github)
new_databl <- add_column(databl, scenario = rep("baseline", 100))
baseline <- new_databl %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP2sc1.csv"
datasc1 <- read_csv(data_github)
new_datasc1 <- add_column(datasc1, scenario = rep("harvest1", 100))
harvest1 <- new_datasc1 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP2sc2.csv"
datasc2 <- read_csv(data_github)
new_datasc2 <- add_column(datasc2, scenario = rep("harvest2", 100))
harvest2 <- new_datasc2 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP2sc3.csv"
datasc3 <- read_csv(data_github)
new_datasc3 <- add_column(datasc3, scenario = rep("harvest3", 100))
harvest3 <- new_datasc3 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP2sc4.csv"
datasc4 <- read_csv(data_github)
new_datasc4 <- add_column(datasc4, scenario = rep("harvest4", 100))
harvest4 <- new_datasc4 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP2sc5.csv"
datasc5 <- read_csv(data_github)
new_datasc5 <- add_column(datasc5, scenario = rep("harvest5", 100))
harvest5 <- new_datasc5 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP2sc6.csv"
datasc6 <- read_csv(data_github)
new_datasc6 <- add_column(datasc6, scenario = rep("harvest6", 100))
harvest6 <- new_datasc6 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP2sc7.csv"
datasc7 <- read_csv(data_github)
new_datasc7 <- add_column(datasc7, scenario = rep("harvest7", 100))
harvest7 <- new_datasc7 %>% select(CWDhuntedDeer, scenario)   #dplyr

prepostharvestN <- data.table(x = c("Preharvest", "Postharvest baseline", "Postharvest Scenario 1", "Postharvest Scenario 2","Postharvest Scenario 3","Postharvest Scenario 4","Postharvest Scenario 5", "Postharvest Scenario 6", "Postharvest Scenario 7"),y = c(round (mean(new_databl[["AdultMale"]]), digits=0), round (mean(new_databl[["PHAdultMale"]]), digits=0), round (mean(new_datasc1[["PHAdultMale"]]), digits=0), round(mean(new_datasc2[["PHAdultMale"]]), digits=0), round(mean(new_datasc3[["PHAdultMale"]]), digits=0), round(mean(new_datasc4[["PHAdultMale"]]), digits=0), round(mean(new_datasc5[["PHAdultMale"]]), digits=0), round(mean(new_datasc6[["PHAdultMale"]]), digits=0), round(mean(new_datasc7[["PHAdultMale"]]), digits=0)), z = c(round (mean(new_databl[["YearlingMale"]]), digits=0), round (mean(new_databl[["PHYearlingMale"]]), digits=0),round (mean(new_datasc1[["PHYearlingMale"]]), digits=0), round(mean(new_datasc2[["PHYearlingMale"]]), digits=0), round(mean(new_datasc3[["PHYearlingMale"]]), digits=0), round(mean(new_datasc4[["PHYearlingMale"]]), digits=0), round(mean(new_datasc5[["PHYearlingMale"]]), digits=0), round(mean(new_datasc6[["PHYearlingMale"]]), digits=0), round(mean(new_datasc7[["PHYearlingMale"]]), digits=0)), a = c(round (mean(new_databl[["FawnMale"]]), digits=0), round (mean(new_databl[["PHFawnMale"]]), digits=0),round (mean(new_datasc1[["PHFawnMale"]]), digits=0), round(mean(new_datasc2[["PHFawnMale"]]), digits=0), round(mean(new_datasc3[["PHFawnMale"]]), digits=0), round(mean(new_datasc4[["PHFawnMale"]]), digits=0), round(mean(new_datasc5[["PHFawnMale"]]), digits=0), round(mean(new_datasc6[["PHFawnMale"]]), digits=0), round(mean(new_datasc7[["PHFawnMale"]]), digits=0)), b = c(round (mean(new_databl[["AdultFemale"]]), digits=0), round (mean(new_databl[["PHAdultFemale"]]), digits=0), round (mean(new_datasc1[["PHAdultFemale"]]), digits=0), round(mean(new_datasc2[["PHAdultFemale"]]), digits=0), round(mean(new_datasc3[["PHAdultFemale"]]), digits=0), round(mean(new_datasc4[["PHAdultFemale"]]), digits=0), round(mean(new_datasc5[["PHAdultFemale"]]), digits=0), round(mean(new_datasc6[["PHAdultFemale"]]), digits=0), round(mean(new_datasc7[["PHAdultFemale"]]), digits=0)), c = c(round (mean(new_databl[["YearlingFemale"]]), digits=0), round (mean(new_databl[["PHYearlingFemale"]]), digits=0),round (mean(new_datasc1[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc2[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc3[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc4[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc5[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc6[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc7[["PHYearlingFemale"]]), digits=0)), d = c(round (mean(new_databl[["FawnFemale"]]), digits=0), round (mean(new_databl[["PHFawnFemale"]]), digits=0),round (mean(new_datasc1[["PHFawnFemale"]]), digits=0), round(mean(new_datasc2[["PHFawnFemale"]]), digits=0), round(mean(new_datasc3[["PHFawnFemale"]]), digits=0), round(mean(new_datasc4[["PHFawnFemale"]]), digits=0), round(mean(new_datasc5[["PHFawnFemale"]]), digits=0), round(mean(new_datasc6[["PHFawnFemale"]]), digits=0), round(mean(new_datasc7[["PHFawnFemale"]]), digits=0)))


colnames(prepostharvestN) <- c("N ","Adult_males","Yearling_males", "Fawn_males", "Adult_females", "Yearling_females", "Fawn_females")

kable(prepostharvestN) %>%
  kable_styling(full_width = F) %>%
  column_spec(2, background = "orange") %>%
  column_spec(3, background = "yellow") %>%
  column_spec(4, background = "yellow") %>%
  column_spec(5, background = "orange") %>%
  column_spec(6, background = "yellow") %>%
  column_spec(7, background = "yellow")

scenariodata <- rbind(baseline, harvest1, harvest2, harvest3, harvest4, harvest5, harvest6, harvest7)

p <- ggplot(data = scenariodata, mapping = aes(x = scenario, y = CWDhuntedDeer, by = scenario))  + geom_boxplot(outlier.shape = NA) +
  geom_jitter(height = 0.075, alpha = 0.2) +
  theme_classic() + scale_y_continuous(breaks = c(0, 1, 2, 3, 4, 5)) + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  geom_hline(yintercept = c(2, 3, 4), color = c("black", "red","blue"),linetype = 2, size = .2) +
  annotate(geom="text", x=7.3, y=2.3, label="50% CWD+ removed",color="black", size = 3) +
  annotate(geom="text", x=7.3, y=3.3, label="75% CWD+ removed",color="red", size = 3) +
  annotate(geom="text", x=7.3, y=4.4, label="100% CWD+ removed",color="blue", size = 3)  #P4 scale_y_cont 0,5,10,15,25;;geom_hline 12.5,18.75,25;;50% annotate y=13.4,19.5, 26.1)#P3 scale_y_cont 0,5,10,15;;geom_hline 6.5,9.75,13;;50%7,10.16,13.8##p2 scale_y_cont 0,1,2,3,4,5;geom_h_line 2,3,4;50%2.3,3.3,4.4;##p1:scale_y_cont 0,1,2,3;;geom_h_line1,1.5,2;;50% 1.1,1.6,2.2
#aes(color = scenario),for geom_jitter
## to add p(elimination) on the plot:  geom_count(data = filter(scenariodata, CWDhuntedDeer == 2), aes(scenario, CWDhuntedDeer)) +
  #geom_text(aes(y = 2.3,label = paste0("n = ", n)), data = scenariodata) +aes(label = count), color = "#ffffff"

#,axis.title.x = element_blank()) + geom_boxplot(outlier.shape = NA)
p1 <- p + ylab("Number of\n CWD+ reindeer harvested") + xlab("\n Harvest scenarios\n") 
  
p1


#ggsave("Nordjfella1Hscenarios20Oct20_boxplot.png")
mod_data <- prepostharvestN[-1,]
colnames(mod_data)[1] <- "scenario"
mod_data[1, 1] = "baseline"
mod_data[2, 1] = "harvest1"
mod_data[3, 1] = "harvest2"
mod_data[4, 1] = "harvest3"
mod_data[5, 1] = "harvest4"
mod_data[6, 1] = "harvest5"
mod_data[7, 1] = "harvest6"
mod_data[8, 1] = "harvest7"

HardangerviddaPrev2 <- p1 +
  geom_point(data = mod_data, aes(x=scenario, y=Adult_males*5/6000), shape = 21, size = 3.5, alpha = 0.4, fill = "darkred") +
  geom_point(data = mod_data, aes(x=scenario, y=Adult_females*5/6000), shape = 21,size = 3.5, alpha = 0.4, fill = "steelblue") +
  scale_y_continuous(limits=c(0, 5), breaks = c(0, 1, 2, 3, 4, 5), sec.axis = sec_axis(~ . *6000/5, name = "Postharvest abundance\n ", breaks = seq(0,6000, by = 1000))) #P4 25/6000;;scale_y_cont limits 0,27;;breaks 0,5,10,15,20,25;;p3 15/6000;;scale_y 0,15;;breaks 0,5,10,15;p2:3/6000, scale y 0,5; breaks 0,1,2,3,4,5;##p1:3/6000;;scale_y0,3;;breaks:0,1,2,3
HardangerviddaPrev2 + annotate ("point", x = 0.9, y = 4.8, color = "steelblue", alpha = 0.4, size = 3) + annotate("label", x = 1.6, y = 4.8, label = "Adult female", size = 3.5) + annotate ("point", x = 2.35, y= 4.8, color = "darkred", alpha = 0.4, size = 3) + annotate("label", x = 2.97, y = 4.8, label = "Adult male", size = 3.5) + ggtitle ("Hardangervidda Prevalence Scenario 2 Harvest regimes")#P4 26.9/26.7/p314.4/p2 4.8/p1 2.8
#ggsave("Hv_P2_Fig1.png")
```
Prevalence scenario 3: 9 adult males, 3 adult females, and 1 yearling male infected

```{r}
data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP3bl.csv"
databl <- read_csv(data_github)
new_databl <- add_column(databl, scenario = rep("baseline", 100))
baseline <- new_databl %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP3sc1.csv"
datasc1 <- read_csv(data_github)
new_datasc1 <- add_column(datasc1, scenario = rep("harvest1", 100))
harvest1 <- new_datasc1 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP3sc2.csv"
datasc2 <- read_csv(data_github)
new_datasc2 <- add_column(datasc2, scenario = rep("harvest2", 100))
harvest2 <- new_datasc2 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP3sc3.csv"
datasc3 <- read_csv(data_github)
new_datasc3 <- add_column(datasc3, scenario = rep("harvest3", 100))
harvest3 <- new_datasc3 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP3sc4.csv"
datasc4 <- read_csv(data_github)
new_datasc4 <- add_column(datasc4, scenario = rep("harvest4", 100))
harvest4 <- new_datasc4 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP3sc5.csv"
datasc5 <- read_csv(data_github)
new_datasc5 <- add_column(datasc5, scenario = rep("harvest5", 100))
harvest5 <- new_datasc5 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP3sc6.csv"
datasc6 <- read_csv(data_github)
new_datasc6 <- add_column(datasc6, scenario = rep("harvest6", 100))
harvest6 <- new_datasc6 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP3sc7.csv"
datasc7 <- read_csv(data_github)
new_datasc7 <- add_column(datasc7, scenario = rep("harvest7", 100))
harvest7 <- new_datasc7 %>% select(CWDhuntedDeer, scenario)   #dplyr

prepostharvestN <- data.table(x = c("Preharvest", "Postharvest baseline", "Postharvest Scenario 1", "Postharvest Scenario 2","Postharvest Scenario 3","Postharvest Scenario 4","Postharvest Scenario 5", "Postharvest Scenario 6", "Postharvest Scenario 7"),y = c(round (mean(new_databl[["AdultMale"]]), digits=0), round (mean(new_databl[["PHAdultMale"]]), digits=0), round (mean(new_datasc1[["PHAdultMale"]]), digits=0), round(mean(new_datasc2[["PHAdultMale"]]), digits=0), round(mean(new_datasc3[["PHAdultMale"]]), digits=0), round(mean(new_datasc4[["PHAdultMale"]]), digits=0), round(mean(new_datasc5[["PHAdultMale"]]), digits=0), round(mean(new_datasc6[["PHAdultMale"]]), digits=0), round(mean(new_datasc7[["PHAdultMale"]]), digits=0)), z = c(round (mean(new_databl[["YearlingMale"]]), digits=0), round (mean(new_databl[["PHYearlingMale"]]), digits=0),round (mean(new_datasc1[["PHYearlingMale"]]), digits=0), round(mean(new_datasc2[["PHYearlingMale"]]), digits=0), round(mean(new_datasc3[["PHYearlingMale"]]), digits=0), round(mean(new_datasc4[["PHYearlingMale"]]), digits=0), round(mean(new_datasc5[["PHYearlingMale"]]), digits=0), round(mean(new_datasc6[["PHYearlingMale"]]), digits=0), round(mean(new_datasc7[["PHYearlingMale"]]), digits=0)), a = c(round (mean(new_databl[["FawnMale"]]), digits=0), round (mean(new_databl[["PHFawnMale"]]), digits=0),round (mean(new_datasc1[["PHFawnMale"]]), digits=0), round(mean(new_datasc2[["PHFawnMale"]]), digits=0), round(mean(new_datasc3[["PHFawnMale"]]), digits=0), round(mean(new_datasc4[["PHFawnMale"]]), digits=0), round(mean(new_datasc5[["PHFawnMale"]]), digits=0), round(mean(new_datasc6[["PHFawnMale"]]), digits=0), round(mean(new_datasc7[["PHFawnMale"]]), digits=0)), b = c(round (mean(new_databl[["AdultFemale"]]), digits=0), round (mean(new_databl[["PHAdultFemale"]]), digits=0), round (mean(new_datasc1[["PHAdultFemale"]]), digits=0), round(mean(new_datasc2[["PHAdultFemale"]]), digits=0), round(mean(new_datasc3[["PHAdultFemale"]]), digits=0), round(mean(new_datasc4[["PHAdultFemale"]]), digits=0), round(mean(new_datasc5[["PHAdultFemale"]]), digits=0), round(mean(new_datasc6[["PHAdultFemale"]]), digits=0), round(mean(new_datasc7[["PHAdultFemale"]]), digits=0)), c = c(round (mean(new_databl[["YearlingFemale"]]), digits=0), round (mean(new_databl[["PHYearlingFemale"]]), digits=0),round (mean(new_datasc1[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc2[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc3[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc4[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc5[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc6[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc7[["PHYearlingFemale"]]), digits=0)), d = c(round (mean(new_databl[["FawnFemale"]]), digits=0), round (mean(new_databl[["PHFawnFemale"]]), digits=0),round (mean(new_datasc1[["PHFawnFemale"]]), digits=0), round(mean(new_datasc2[["PHFawnFemale"]]), digits=0), round(mean(new_datasc3[["PHFawnFemale"]]), digits=0), round(mean(new_datasc4[["PHFawnFemale"]]), digits=0), round(mean(new_datasc5[["PHFawnFemale"]]), digits=0), round(mean(new_datasc6[["PHFawnFemale"]]), digits=0), round(mean(new_datasc7[["PHFawnFemale"]]), digits=0)))


colnames(prepostharvestN) <- c("N ","Adult_males","Yearling_males", "Fawn_males", "Adult_females", "Yearling_females", "Fawn_females")

kable(prepostharvestN) %>%
  kable_styling(full_width = F) %>%
  column_spec(2, background = "orange") %>%
  column_spec(3, background = "yellow") %>%
  column_spec(4, background = "yellow") %>%
  column_spec(5, background = "orange") %>%
  column_spec(6, background = "yellow") %>%
  column_spec(7, background = "yellow")

scenariodata <- rbind(baseline, harvest1, harvest2, harvest3, harvest4, harvest5, harvest6, harvest7)

p <- ggplot(data = scenariodata, mapping = aes(x = scenario, y = CWDhuntedDeer, by = scenario))  + geom_boxplot(outlier.shape = NA) +
  geom_jitter(height = 0.075, alpha = 0.2) +
  theme_classic() + scale_y_continuous(breaks = c(0, 5, 10, 15)) + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  geom_hline(yintercept = c(6.5, 9.75, 13), color = c("black", "red","blue"),linetype = 2, size = .2) +
  annotate(geom="text", x=7.3, y=7, label="50% CWD+ removed",color="black", size = 3) +
  annotate(geom="text", x=7.3, y=10.16, label="75% CWD+ removed",color="red", size = 3) +
  annotate(geom="text", x=7.3, y=13.8, label="100% CWD+ removed",color="blue", size = 3)  #P4 scale_y_cont 0,5,10,15,25;;geom_hline 12.5,18.75,25;;50% annotate y=13.4,19.5, 26.1)#P3 scale_y_cont 0,5,10,15;;geom_hline 6.5,9.75,13;;50%7,10.16,13.8##p2 scale_y_cont 0,1,2,3,4,5;geom_h_line 2,3,4;50%2.3,3.3,4.4;##p1:scale_y_cont 0,1,2,3;;geom_h_line1,1.5,2;;50% 1.1,1.6,2.2
#aes(color = scenario),for geom_jitter
## to add p(elimination) on the plot:  geom_count(data = filter(scenariodata, CWDhuntedDeer == 2), aes(scenario, CWDhuntedDeer)) +
  #geom_text(aes(y = 2.3,label = paste0("n = ", n)), data = scenariodata) +aes(label = count), color = "#ffffff"

#,axis.title.x = element_blank()) + geom_boxplot(outlier.shape = NA)
p1 <- p + ylab("Number of\n CWD+ reindeer harvested") + xlab("\n Harvest scenarios\n") 
  
p1


#ggsave("Nordjfella1Hscenarios20Oct20_boxplot.png")
mod_data <- prepostharvestN[-1,]
colnames(mod_data)[1] <- "scenario"
mod_data[1, 1] = "baseline"
mod_data[2, 1] = "harvest1"
mod_data[3, 1] = "harvest2"
mod_data[4, 1] = "harvest3"
mod_data[5, 1] = "harvest4"
mod_data[6, 1] = "harvest5"
mod_data[7, 1] = "harvest6"
mod_data[8, 1] = "harvest7"

HardangerviddaPrev3 <- p1 +
  geom_point(data = mod_data, aes(x=scenario, y=Adult_males*15/6000), shape = 21, size = 3.5, alpha = 0.4, fill = "darkred") +
  geom_point(data = mod_data, aes(x=scenario, y=Adult_females*15/6000), shape = 21,size = 3.5, alpha = 0.4, fill = "steelblue") +
  scale_y_continuous(limits=c(0, 15), breaks = c(0, 5, 10, 15), sec.axis = sec_axis(~ . *6000/15, name = "Postharvest abundance\n ", breaks = seq(0,6000, by = 1000))) #P4 25/6000;;scale_y_cont limits 0,27;;breaks 0,5,10,15,20,25;;p3 15/6000;;scale_y 0,15;;breaks 0,5,10,15;p2:3/6000, scale y 0,5; breaks 0,1,2,3,4,5;##p1:3/6000;;scale_y0,3;;breaks:0,1,2,3
HardangerviddaPrev3 + annotate ("point", x = 0.9, y = 14.4, color = "steelblue", alpha = 0.4, size = 3) + annotate("label", x = 1.6, y = 14.4, label = "Adult female", size = 3.5) + annotate ("point", x = 2.35, y= 14.4, color = "darkred", alpha = 0.4, size = 3) + annotate("label", x = 2.97, y = 14.4, label = "Adult male", size = 3.5) + ggtitle ("Hardangervidda Prevalence Scenario 3 Harvest regimes")#P4 26.9/26.7/p314.4/p2 4.8/p1 2.8
#ggsave("Hv_P2_Fig1.png")
```

Prevalence scenario 4: 18 adult males, 6 adult females, and 1 yearling male infected

```{r}

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP4bl.csv"
databl <- read_csv(data_github)
new_databl <- add_column(databl, scenario = rep("baseline", 100))
baseline <- new_databl %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP4sc1.csv"
datasc1 <- read_csv(data_github)
new_datasc1 <- add_column(datasc1, scenario = rep("harvest1", 100))
harvest1 <- new_datasc1 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP4sc2.csv"
datasc2 <- read_csv(data_github)
new_datasc2 <- add_column(datasc2, scenario = rep("harvest2", 100))
harvest2 <- new_datasc2 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP4sc3.csv"
datasc3 <- read_csv(data_github)
new_datasc3 <- add_column(datasc3, scenario = rep("harvest3", 100))
harvest3 <- new_datasc3 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP4sc4.csv"
datasc4 <- read_csv(data_github)
new_datasc4 <- add_column(datasc4, scenario = rep("harvest4", 100))
harvest4 <- new_datasc4 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP4sc5.csv"
datasc5 <- read_csv(data_github)
new_datasc5 <- add_column(datasc5, scenario = rep("harvest5", 100))
harvest5 <- new_datasc5 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP4sc6.csv"
datasc6 <- read_csv(data_github)
new_datasc6 <- add_column(datasc6, scenario = rep("harvest6", 100))
harvest6 <- new_datasc6 %>% select(CWDhuntedDeer, scenario)   #dplyr

data_github <- "https://raw.githubusercontent.com/anyadoc/ABMDataNorwayReindeerCWD/main/CWDsurveillanceNO_HvP4sc7.csv"
datasc7 <- read_csv(data_github)
new_datasc7 <- add_column(datasc7, scenario = rep("harvest7", 100))
harvest7 <- new_datasc7 %>% select(CWDhuntedDeer, scenario)   #dplyr

prepostharvestN <- data.table(x = c("Preharvest", "Postharvest baseline", "Postharvest Scenario 1", "Postharvest Scenario 2","Postharvest Scenario 3","Postharvest Scenario 4","Postharvest Scenario 5", "Postharvest Scenario 6", "Postharvest Scenario 7"),y = c(round (mean(new_databl[["AdultMale"]]), digits=0), round (mean(new_databl[["PHAdultMale"]]), digits=0), round (mean(new_datasc1[["PHAdultMale"]]), digits=0), round(mean(new_datasc2[["PHAdultMale"]]), digits=0), round(mean(new_datasc3[["PHAdultMale"]]), digits=0), round(mean(new_datasc4[["PHAdultMale"]]), digits=0), round(mean(new_datasc5[["PHAdultMale"]]), digits=0), round(mean(new_datasc6[["PHAdultMale"]]), digits=0), round(mean(new_datasc7[["PHAdultMale"]]), digits=0)), z = c(round (mean(new_databl[["YearlingMale"]]), digits=0), round (mean(new_databl[["PHYearlingMale"]]), digits=0),round (mean(new_datasc1[["PHYearlingMale"]]), digits=0), round(mean(new_datasc2[["PHYearlingMale"]]), digits=0), round(mean(new_datasc3[["PHYearlingMale"]]), digits=0), round(mean(new_datasc4[["PHYearlingMale"]]), digits=0), round(mean(new_datasc5[["PHYearlingMale"]]), digits=0), round(mean(new_datasc6[["PHYearlingMale"]]), digits=0), round(mean(new_datasc7[["PHYearlingMale"]]), digits=0)), a = c(round (mean(new_databl[["FawnMale"]]), digits=0), round (mean(new_databl[["PHFawnMale"]]), digits=0),round (mean(new_datasc1[["PHFawnMale"]]), digits=0), round(mean(new_datasc2[["PHFawnMale"]]), digits=0), round(mean(new_datasc3[["PHFawnMale"]]), digits=0), round(mean(new_datasc4[["PHFawnMale"]]), digits=0), round(mean(new_datasc5[["PHFawnMale"]]), digits=0), round(mean(new_datasc6[["PHFawnMale"]]), digits=0), round(mean(new_datasc7[["PHFawnMale"]]), digits=0)), b = c(round (mean(new_databl[["AdultFemale"]]), digits=0), round (mean(new_databl[["PHAdultFemale"]]), digits=0), round (mean(new_datasc1[["PHAdultFemale"]]), digits=0), round(mean(new_datasc2[["PHAdultFemale"]]), digits=0), round(mean(new_datasc3[["PHAdultFemale"]]), digits=0), round(mean(new_datasc4[["PHAdultFemale"]]), digits=0), round(mean(new_datasc5[["PHAdultFemale"]]), digits=0), round(mean(new_datasc6[["PHAdultFemale"]]), digits=0), round(mean(new_datasc7[["PHAdultFemale"]]), digits=0)), c = c(round (mean(new_databl[["YearlingFemale"]]), digits=0), round (mean(new_databl[["PHYearlingFemale"]]), digits=0),round (mean(new_datasc1[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc2[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc3[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc4[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc5[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc6[["PHYearlingFemale"]]), digits=0), round(mean(new_datasc7[["PHYearlingFemale"]]), digits=0)), d = c(round (mean(new_databl[["FawnFemale"]]), digits=0), round (mean(new_databl[["PHFawnFemale"]]), digits=0),round (mean(new_datasc1[["PHFawnFemale"]]), digits=0), round(mean(new_datasc2[["PHFawnFemale"]]), digits=0), round(mean(new_datasc3[["PHFawnFemale"]]), digits=0), round(mean(new_datasc4[["PHFawnFemale"]]), digits=0), round(mean(new_datasc5[["PHFawnFemale"]]), digits=0), round(mean(new_datasc6[["PHFawnFemale"]]), digits=0), round(mean(new_datasc7[["PHFawnFemale"]]), digits=0)))


colnames(prepostharvestN) <- c("N ","Adult_males","Yearling_males", "Fawn_males", "Adult_females", "Yearling_females", "Fawn_females")

kable(prepostharvestN) %>%
  kable_styling(full_width = F) %>%
  column_spec(2, background = "orange") %>%
  column_spec(3, background = "yellow") %>%
  column_spec(4, background = "yellow") %>%
  column_spec(5, background = "orange") %>%
  column_spec(6, background = "yellow") %>%
  column_spec(7, background = "yellow")

scenariodata <- rbind(baseline, harvest1, harvest2, harvest3, harvest4, harvest5, harvest6, harvest7)

p <- ggplot(data = scenariodata, mapping = aes(x = scenario, y = CWDhuntedDeer, by = scenario))  + geom_boxplot(outlier.shape = NA) +
  geom_jitter(height = 0.075, alpha = 0.2) +
  theme_classic() + scale_y_continuous(breaks = c(0, 5, 10, 15, 25)) + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  geom_hline(yintercept = c(12.5, 18.75, 25), color = c("black", "red","blue"),linetype = 2, size = .2) +
  annotate(geom="text", x=7.3, y=13.4, label="50% CWD+ removed",color="black", size = 3) +
  annotate(geom="text", x=7.3, y=19.5, label="75% CWD+ removed",color="red", size = 3) +
  annotate(geom="text", x=7.3, y=26.1, label="100% CWD+ removed",color="blue", size = 3)  #P4 scale_y_cont 0,5,10,15,25;;geom_hline 12.5,18.75,25;;50% annotate y=13.4,19.5, 26.1)#P3 scale_y_cont 0,5,10,15;;geom_hline 6.5,9.75,13;;50%7,10.16,13.8##p2 scale_y_cont 0,1,2,3,4,5;geom_h_line 2,3,4;50%2.3,3.3,4.4;##p1:scale_y_cont 0,1,2,3;;geom_h_line1,1.5,2;;50% 1.1,1.6,2.2
#aes(color = scenario),for geom_jitter
## to add p(elimination) on the plot:  geom_count(data = filter(scenariodata, CWDhuntedDeer == 2), aes(scenario, CWDhuntedDeer)) +
  #geom_text(aes(y = 2.3,label = paste0("n = ", n)), data = scenariodata) +aes(label = count), color = "#ffffff"

#,axis.title.x = element_blank()) + geom_boxplot(outlier.shape = NA)
p1 <- p + ylab("Number of\n CWD+ reindeer harvested") + xlab("\n Harvest scenarios\n") 
  
p1


#ggsave("Nordjfella1Hscenarios20Oct20_boxplot.png")
mod_data <- prepostharvestN[-1,]
colnames(mod_data)[1] <- "scenario"
mod_data[1, 1] = "baseline"
mod_data[2, 1] = "harvest1"
mod_data[3, 1] = "harvest2"
mod_data[4, 1] = "harvest3"
mod_data[5, 1] = "harvest4"
mod_data[6, 1] = "harvest5"
mod_data[7, 1] = "harvest6"
mod_data[8, 1] = "harvest7"

HardangerviddaPrev4 <- p1 +
  geom_point(data = mod_data, aes(x=scenario, y=Adult_males*25/6000), shape = 21, size = 3.5, alpha = 0.4, fill = "darkred") +
  geom_point(data = mod_data, aes(x=scenario, y=Adult_females*25/6000), shape = 21,size = 3.5, alpha = 0.4, fill = "steelblue") +
  scale_y_continuous(limits=c(0, 27), breaks = c(0, 5, 10, 15, 20, 25), sec.axis = sec_axis(~ . *6000/25, name = "Postharvest abundance\n ", breaks = seq(0,6000, by = 1000))) #P4 25/6000;;scale_y_cont limits 0,27;;breaks 0,5,10,15,20,25;;p3 15/6000;;scale_y 0,15;;breaks 0,5,10,15;p2:3/6000, scale y 0,5; breaks 0,1,2,3,4,5;##p1:3/6000;;scale_y0,3;;breaks:0,1,2,3
HardangerviddaPrev4 + annotate ("point", x = 0.9, y = 26.9, color = "steelblue", alpha = 0.4, size = 3) + annotate("label", x = 1.6, y = 26.9, label = "Adult female", size = 3.5) + annotate ("point", x = 2.35, y= 26.9, color = "darkred", alpha = 0.4, size = 3) + annotate("label", x = 2.97, y = 26.9, label = "Adult male", size = 3.5) + ggtitle ("Hardangervidda Prevalence Scenario 4 Harvest regimes")#P4 26.9/26.7/p314.4/p2 4.8/p1 2.8
#ggsave("Hv_P2_Fig1.png")
```
